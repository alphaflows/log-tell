version: "3.9"

# Copy .env.example to .env before running to configure credentials and monitor behavior.

services:
  # -------------------------------
  # OpenObserve
  # -------------------------------
  openobserve:
    image: public.ecr.aws/zinclabs/openobserve:latest
    container_name: openobserve
    environment:
      - ZO_ROOT_USER_EMAIL=${ZO_ROOT_USER_EMAIL}
      - ZO_ROOT_USER_PASSWORD=${ZO_ROOT_USER_PASSWORD}
    ports:
      - "5080:5080"
      - "5081:5081"
    volumes:
      - ./data:/data
    restart: unless-stopped

  # -------------------------------
  # Python Monitoring Agent
  # -------------------------------
  logagent:
    build:
      context: ./monitor
      dockerfile: Dockerfile
    container_name: logagent
    env_file:
      - .env
    depends_on:
      - openobserve
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock  # âœ… allow reading docker logs
    environment:
      - PYTHONUNBUFFERED=1
    restart: unless-stopped
